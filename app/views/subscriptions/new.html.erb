<% content_for :head do %>
	<%= javascript_include_tag 'gmap' %>
	<script type="text/javascript"
          src="http://maps.google.com/maps/api/js?sensor=false">
	</script>
<% end  %>

<div id="subscriptions">
	<%= semantic_form_for(@subscription) do |f| %>
		<%= f.inputs do %>
			<%= f.input :latitude, :as => :hidden  %>
    	<%= f.input :longitude, :as => :hidden  %>
      <%= f.input :distance %>
			<%= f.input :email %>
	  <% end %>
		<%= f.buttons %>
	<% end %>
</div>

<div id="right" class="grid_4  omega">
	  <input id="address" /> 
	<div id="map" style="background: #ccc; width:300px; height: 300px;"></div>
		<script type="text/javascript">
				$(document).ready(function(){
		    		dynamic_gmap_with_marker("map", <%= @subscription.latitude %>, <%= @subscription.longitude%>, "Wo?");
				});
		</script>
	</div>      
</div><!--right-->

<script type="text/javascript">
	$(document).ready(function(){
    $('#mapsearchform').submit(function(){
      update_map_by_address($('#address').val());
      return false;
    })

    addMarkerChangedListener('subscriptions_latitude', 'subscriptions_longitude');
  });
</script>